<!DOCTYPE html>
<html lang="en">
    <head>
	<meta charset="UTF-8">
	<title>API TESTING</title>

	<base href="/repo_deploy/">

	<!-- W3C LOGGING -->
	<script>
	 wcENV="dev"; // prod || dev
	 wcAPP="NALA";
	</script>
    </head>

    <body id="wc">
	<script src="js/_wc.js"></script>
	<script src="test/tmp/mtk-wc-api.js"></script>
	<script src="js/api.js"></script>

	<div id="api_base" value=""</div>

	<pre id="req_out"></pre>
	<pre id="res_out"></pre>

	<span id="last_method"></span>
	<span id="last_url"></span>
	<span id="last_status"></span>
	<pre id="session_out"></pre>

	<h1>OPEN THE CONSOLE</h1>

	<!-- FOR API TESTING -->
	<script>
	 let url = "https://nala-test.com";
	 
	 async function doLogout() {
	     // LOGOUT
	     const res = await fetch(url + "/api/auth_logout.php", {
		 method: "POST",
		 credentials: "include"
	     });
	     const data = await res.json().catch(() => ({}));
	     if (!res.ok) throw new Error(data.error || "Logout failed");
	     let currentUser = null;
	     console.log("logged out", data);

	     wc.log("logged out");
	 }

	 async function doLogin(email,passwd) {
	     // LOGIN
	     const res = await fetch(url + "/api/login_api.php", {
		 method: "POST",
		 credentials: "include",
		 headers: { "Content-Type": "application/json" },
		 body: JSON.stringify({
		     email: email,
		     password: passwd
		 })
	     });
	     const data = await res.json();
	     if (!res.ok) throw new Error(data.error || "Login failed");
	     const currentUser = data.user;

	     wc.log("logged in", currentUser);
	     return res;
	 }
	 
	 switch(2) 
	 {
	     case 1:
	     doLogout();
	     break;
	     
	     case 2:
	     doLogin("mel@google.com", "test");
	     break;
	 }
	</script>

    </body>
</html>
