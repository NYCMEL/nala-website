<!DOCTYPE html>
<html lang="en">
    <head>
	<meta charset="UTF-8">
	<title>API TESTING</title>

	<base href="/repo_deploy/">

	<!-- W3C LOGGING -->
	<script>
	 wcENV="dev"; // prod || dev
	 wcAPP="NALA";
	 wcTOKEN = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9." +
		   "eyJ1c2VySWQiOiJ0ZXN0LXVzZXIiLCJyb2xlIjoiZGV2IiwiZXhwIjo5OTk5OTk5OTk5fQ." +
		   "dGhpcy1pcy1hLWZha2UtdG9rZW4tZm9yLXRlc3Rpbmc";
	</script>
    </head>

    <body id="wc">
	<script src="js/_wc.js"></script>
	<script src="js/api.js"></script>

	<div id="api_base" value=""</div>

	<pre id="req_out"></pre>
	<pre id="res_out"></pre>

	<span id="last_method"></span>
	<span id="last_url"></span>
	<span id="last_status"></span>
	<pre id="session_out"></pre>

	<h1>OPEN THE CONSOLE</h1>

	<!-- FOR API TESTING -->
	<script>
	 let url = "https://nala-test.com";
	 
	 // data FOR LOGIN TESTING
	 let email = "mel@google.com";
	 let password = "testing";

	 document.body.innerHTML += "<p>" + url + "</p>";

	 switch(test=2) 
	 {
	     case 1:
	     var r = wc.fetch(url + "/api/curriculum.json");
	     wc.log("curriculum:", r);
	     document.body.innerHTML += JSON.stringify(r);
	     break;

	     case 2:
	     async function loginMEL() {
		 await callApi({ method: "POST", path: url + "/api/login_api.php", jsonBody: { email, password } });
		 setTimeout(me, 250);
	     }

	     var r = loginMEL("mel@google.com", "hello")
	     document.body.innerHTML += "RESULT:" + JSON.stringify(r);
	     break;

	     case 3:
	     wc.post(url + "/api/login_api.php", {
		 email: "user@test.com",
		 password: "secret"
	     }).then(data => {
		 wc.log("Login success", data);
	     }).catch(err => {
		 wc.warn("Login failed", err);
	     });
	     break;
	 }
	</script>
    </body>
</html>
